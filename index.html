<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/style.css">
    <title>VSKY.GAME</title>
</head>

<body>
    <header>
        <h1>VSKY.GG</h1>
    </header>
    <div id="page-content">
        <div id="kategorie">
            <select id="select" onchange="setDictionarySelect();">
                <optgroup label="Italiano">
                    <option value="dictionarydef">Default</option>
                    <option value="dictionarydef">50</option>
                    <option value="dictionary1">Kolory</option>
                    <option value="dictionary2">Zwierzęta</option>
                    <option value="dictionary3">Jedzenie</option>
                    <option value="dictionary4">Kierunki</option>
                    <option value="dictionary5">Podstawowe zwroty</option>
                    <option value="dictionary6">Czas</option>
                    <option value="dictionary8">Regularne</option>
                    <option value="dictionary9">Nieregularne</option>
                </optgroup>
                <optgroup label="English">
                    <option value="dictionary_eng_useful">Useful</option>
                    <option value="dictionary_eng4">Character Traits</option>
                    <option value="dictionary_eng_matura">Matura 2024</option>
                    <option value="dictionary_eng3">Synonyms</option>
                    <option value="dictionary_eng1">Fish4Words</option>
                    <option value="dictionary_eng2">Phrasal Verbs</option>
                </optgroup>
                <optgroup label="Deutsch">

                </optgroup>
            </select>
            <input id="refresh" type="button" value="Refresh" onClick="location.reload();" />
        </div>
        <div id="game-searched-word">
            <p id="recommendation">Write the translation: </p>
            <p id="searched-word"></p>

            <div id="game-form">
                <input type="text" id="user-word" placeholder="" autocomplete="off" inputmode="text">
                <input type="submit" id="submit" value="→" onclick="check();">
            </div>

            <p id="wynik"></p>
            <p id="character-map"><span class="myText">à</span><span class="myText">è</span><span
                    class="myText">ì</span><span class="myText">ò</span><span class="myText">ù</span><span
                    class="myText">’</span><span class="myText">?</span></p>
        </div>
        <div id="dictionary">
            <h2>Dictionary</h2>
            <input type="text" id="searchelement" placeholder="Search..." autocomplete="off" inputmode="text">
            <!--
            <div class="word-cont">
                <p class="word">grande</p>
                <p class="pause">—</p>
                <p class="translate">duży</p>
            </div>
            -->
        </div>
    </div>
    <div id="mobile-widgets">
        <a id="gomenu" onclick="move(1);">Reset</a>
        <a id="gomenu" onclick="move(2);">Dictionary</a>
        <a id="gomenu" onclick="move(3);">Game</a>
    </div>
</body>

</html>
<script src="JS/dictionary-eng.js"></script>
<script src="JS/dictionary.js"></script>
<script>
    var wrong_answers = {

    };
</script>
<script>
    function move(value) {
        switch (value) {
            case 1:
                document.getElementById('searchelement').value = '';
                var elements = document.querySelectorAll('.word-cont');
                for (var i = 0; i < elements.length; i++) {
                    elements[i].style.display = "";
                }

                document.getElementById('searchelement').focus();
                break;
            case 2:
                document.getElementById('searchelement').focus();
                break;
            case 3:
                document.getElementById('user-word').focus();
                break;
        }
    }
</script>
<script>
    function setDictionarySelect() {
        //setDictionary();
        var select = document.getElementById("select").value;
        //alert(select);
        setDictionary(select);
    }
    // Funkcja do ustawiania ciasteczka
    function setCookie(name, value, expiryHours) {
        var date = new Date();
        date.setTime(date.getTime() + (expiryHours * 60 * 60 * 1000));
        var expires = "expires=" + date.toUTCString();
        document.cookie = name + "=" + value + ";" + expires + ";path=/";
        console.log("Ustawiono na: " + expires);
    }

    // Funkcja do pobierania ciasteczka
    function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    // Funkcja do wyboru słownika
    function setDictionary(dictionaryName) {
        // Zapisanie nazwy wybranego słownika w ciasteczku na 1 godzinę
        setCookie('selectedDictionary', dictionaryName, 2);
        console.log("Ustawiono: " + dictionaryName);
    }

    // Wywołanie funkcji setDictionary z wybranym słownikiem
    //setDictionary('dictionary1');
    console.log(getCookie('selectedDictionary'));

    // Tworzenie zmiennej dictionary i przypisanie do niej słownika pobranego z ciasteczka
    var selectedDictionaryName = getCookie('selectedDictionary');
    var dictionary;

    if (selectedDictionaryName) {
        dictionary = window[selectedDictionaryName];
    } else {
        console.log("Nie znaleziono słownika w pliku cookie");
        dictionary = {
            "grande": "duży",
            "stesso": "ten sam",
            "bello": "piękny",
            "nuovo": "nowy",
            "certo": "pewny",
            "vero": "prawdziwy",
            "buono": "dobry",
            "italiano": "włoski",
            "vecchio": "stary",
            "ora": "teraz",
            "qui": "tutaj",
            "là": "tam",
            "sempre": "zawsze",
            "mai": "nigdy",
            "molto": "bardzo",
            "troppo": "zbyt",
            "bene": "dobrze",
            "male": "źle",
            "velocemente": "szybko",
            "lentamente": "powoli",
            "spesso": "często",
            "a volte": "czasami",
            "d’ora in poi": "od teraz",
            "amore": "miłość",
            "tempo": "czas",
            "uomo": "mężczyzna",
            "anno": "rok",
            "giorno": "dzień",
            "mano": "ręka",
            "occhio": "oko",
            "cosa": "rzecz",
            "parte": "część",
            "vita": "życie",
            "ora": "godzina",
            "madre": "matka",
            "padre": "ojciec",
            "figlio": "syn",
            "mondo": "świat",
            "casa": "dom",
            "posto": "miejsce",
            "lavoro": "praca",
            "settimana": "tydzień",
            "momento": "moment",
            "donna": "kobieta",
            "paese": "kraj",
            "amico": "przyjaciel",
            "piede": "stopa",
            "corpo": "ciało",
            "bambino": "dziecko",
            "problema": "problem"
        };
    }

    // Zmienna do przechowywania wyniku
    var score = 0;

    // Zmienna do przechowywania liczby prób
    var attempts = 0;

    var selectedWords = [];

    // Funkcja do losowania 10 niepowtarzających się słów
    function selectWords() {
        var keys = Object.keys(dictionary);
        while (selectedWords.length < 10) {
            var randomIndex = Math.floor(Math.random() * keys.length);
            var word = keys[randomIndex];
            if (!selectedWords.includes(word)) {
                selectedWords.push(word);
            }
        }
    }

    // Funkcja do wyświetlania słowa do przetłumaczenia
    function displayWord() {
        var resultField = document.getElementById("wynik");

        if (attempts < 10) {
            var word = dictionary[selectedWords[attempts]];
            document.getElementById("searched-word").innerText = word;
        } else {
            document.getElementById("wynik").innerText = "Your score is: " + score + "/10";
            /*var container = document.getElementById('wynik');
    for (var key in wrong_answers) {
        var p = document.createElement('p');
        p.textContent = key + ": " + wrong_answers[key];
        container.appendChild(p);
    }*/
            /*var container = document.getElementById('wynik');
            for (var key in wrong_answers) {
                var p = document.createElement('p');
                var keySpan = document.createElement('span');
                var valueSpan = document.createElement('span');
        
                keySpan.textContent = key + ": ";
                keySpan.style.color = "red"; // kolor dla klucza
        
                valueSpan.textContent = wrong_answers[key];
                valueSpan.style.color = "green"; // kolor dla wartości
        
                p.appendChild(keySpan);
                p.appendChild(valueSpan);
                container.appendChild(p);
            }*/
            /*var wynik = document.getElementById('wynik');
        var kolory = ['red', 'green', 'blue']; // Możesz dodać więcej kolorów do tej tablicy
        
        for (var pole in wrong_answers) {
            if (wrong_answers.hasOwnProperty(pole)) {
                var paragrafPole = document.createElement('p');
                paragrafPole.textContent = 'Pole: ' + pole;
                paragrafPole.style.color = kolory[0];
        
                var paragrafOdpowiedz1 = document.createElement('p');
                paragrafOdpowiedz1.textContent = 'Odpowiedź 1: ' + wrong_answers[pole].answer1;
                paragrafOdpowiedz1.style.color = kolory[1];
        
                var paragrafOdpowiedz2 = document.createElement('p');
                paragrafOdpowiedz2.textContent = 'Odpowiedź 2: ' + wrong_answers[pole].answer2;
                paragrafOdpowiedz2.style.color = kolory[2];
        
                wynik.appendChild(paragrafPole);
                wynik.appendChild(paragrafOdpowiedz1);
                wynik.appendChild(paragrafOdpowiedz2);
            }
        }*/
            /*var wynik = document.getElementById('wynik');
            
            for (var pole in wrong_answers) {
                if (wrong_answers.hasOwnProperty(pole)) {
                    var paragrafPole = document.createElement('p');
                    paragrafPole.textContent = pole;
                    paragrafPole.style.color = 'red';
            
                    var paragrafAnswer1 = document.createElement('p');
                    paragrafAnswer1.textContent = wrong_answers[pole].answer1;
                    paragrafAnswer1.style.color = 'green';
            
                    var paragrafAnswer2 = document.createElement('p');
                    paragrafAnswer2.textContent = wrong_answers[pole].answer2;
                    paragrafAnswer2.style.color = 'black';
            
                    wynik.appendChild(paragrafPole);
                    wynik.appendChild(paragrafAnswer1);
                    wynik.appendChild(paragrafAnswer2);
                }
            }*/
            var wynik = document.getElementById('wynik');

            for (var pole in wrong_answers) {
                if (wrong_answers.hasOwnProperty(pole)) {
                    var paragraf = document.createElement('p');
                    paragraf.innerHTML = '<span style="color:red;">' + wrong_answers[pole].answer1 + '</span> ' +
                        '<span style="color:green;">' + wrong_answers[pole].answer2 + '</span> ' +
                        '<span style="color:black;">' + wrong_answers[pole].answer3 + '</span>';
                    wynik.appendChild(paragraf);
                }
            }


            document.getElementById("recommendation").innerText = "Summary";
            document.getElementById("user-word").style.display = "none";
            document.getElementById("submit").style.display = "none";
            document.getElementById("searched-word").style.display = "none";
            document.getElementById("character-map").style.display = "none";

            // Usuwanie poprzednich klas
            resultField.classList.remove("true");
            resultField.classList.remove("false");

            // Dodawanie klasy w zależności od wyniku
            if (score < 5) {
                resultField.classList.add("false");
            } else if (score > 5) {
                resultField.classList.add("true");
            }
        }
    }

    // Funkcja do sprawdzania poprawności tłumaczenia
    var wrong_answers_index = 0;

    function checkTranslation() {
        var searchedWord = document.getElementById("searched-word").innerText;
        var userWord = document.getElementById("user-word").value;
        var resultField = document.getElementById("wynik");

        // Usuwanie poprzednich klas
        resultField.classList.remove("true");
        resultField.classList.remove("false");

        if (Object.keys(dictionary).find(key => dictionary[key] === searchedWord).toLowerCase() === userWord.toLowerCase()) {
            score++;
            resultField.innerText = "Correct translation!";
            resultField.classList.add("true");
        } else {
            resultField.innerText = "Incorrect translation. The correct translation is: " + Object.keys(dictionary).find(key => dictionary[key] === searchedWord);
            var correct_answer = Object.keys(dictionary).find(key => dictionary[key] === searchedWord);
            var translate_answer = searchedWord;
            if (userWord != "") {
                var incorrect_answer = userWord;
            } else {
                var incorrect_answer = "---";
            }

            wrong_answers[wrong_answers_index] = {
                answer1: incorrect_answer,
                answer2: correct_answer,
                answer3: translate_answer
            };
            wrong_answers_index++;
            resultField.classList.add("false");
            console.log(wrong_answers);
        }

        attempts++;
        // Przejście do kolejnego słowa
        displayWord();
    }

    // Wywołanie funkcji displayWord po załadowaniu strony
    window.onload = function () {
        selectWords();
        displayWord();
    };
    function check() {
        checkTranslation();
        document.getElementById("user-word").value = "";
    }
    // Dodanie nasłuchiwania na zdarzenie 'keydown' dla pola "user-word"
    document.getElementById("user-word").addEventListener('keydown', function (event) {
        if (event.key === "Enter") {
            checkTranslation();
            // Czyszczenie pola "user-word"
            document.getElementById("user-word").value = "";
        }
    });
</script>
<script>
    // Funkcja do wypisywania par klucz-wartość ze słownika do elementu o danym id
    function printDictionaryToElement(dictionary, elementId) {
        // Pobranie elementu o danym id
        let element = document.getElementById(elementId);

        // Sprawdzenie czy element istnieje
        if (element) {
            // Wypisanie każdej pary klucz-wartość ze słownika do elementu
            for (let key in dictionary) {
                if (dictionary.hasOwnProperty(key)) {
                    let wordCont = document.createElement("div");
                    wordCont.className = "word-cont";

                    let word = document.createElement("p");
                    word.className = "word";
                    word.textContent = key;

                    let pause = document.createElement("p");
                    pause.className = "pause";
                    pause.textContent = "—";

                    let translate = document.createElement("p");
                    translate.className = "translate";
                    translate.textContent = dictionary[key];

                    wordCont.appendChild(word);
                    wordCont.appendChild(pause);
                    wordCont.appendChild(translate);

                    element.appendChild(wordCont);
                }
            }
        } else {
            console.log("Element o id " + elementId + " nie istnieje.");
        }
    }

    // Wywołanie funkcji
    printDictionaryToElement(dictionary, "dictionary");  
</script>
<script>
    // Pobranie elementów
    let myTexts = document.getElementsByClassName("myText");

    // Dodanie nasłuchiwania na kliknięcie do każdego elementu
    for (let i = 0; i < myTexts.length; i++) {
        let myText = myTexts[i];

        myText.addEventListener("click", function () {
            // Utworzenie obiektu Range i dodanie do niego naszego elementu
            let range = document.createRange();
            range.selectNode(myText);

            // Usunięcie wszystkich zaznaczeń
            window.getSelection().removeAllRanges();

            // Dodanie naszego Range do zaznaczenia
            window.getSelection().addRange(range);

            try {
                // Próba skopiowania tekstu zaznaczenia do schowka
                document.execCommand('copy');
            } catch (err) {
                console.log('Nie udało się skopiować tekstu');
            }

            // Usunięcie zaznaczenia po skopiowaniu tekstu
            window.getSelection().removeAllRanges();

            // Dopisanie tekstu do istniejącego tekstu w polu input o id "user-word"
            let userInput = document.getElementById("user-word");
            if (userInput) {
                userInput.value += myText.textContent;
                document.getElementById('user-word').focus();
            } else {
                console.log('Pole input o id "user-word" nie istnieje.');
            }
        });
    }
</script>
<script>
    document.querySelector('#searchelement').addEventListener('input', function (e) {
        let searchValue = e.target.value.toLowerCase();
        let verbContainers = document.querySelectorAll('.word-cont');

        verbContainers.forEach(function (container) {
            let textValue = container.textContent || container.innerText;
            if (textValue.toLowerCase().indexOf(searchValue) > -1) {
                container.style.display = "";
            } else {
                container.style.display = "none";
            }
        });
    });
</script>